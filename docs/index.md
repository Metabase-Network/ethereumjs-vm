<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [vm.runBlockchain][1]
    -   [Parameters][2]
-   [VM][3]
    -   [Parameters][4]
-   [vm.runBlock][5]
    -   [Parameters][6]
-   [runBlock~callback][7]
    -   [Parameters][8]
-   [runTx~callback][9]
    -   [Parameters][10]
-   [vm.runTx][11]
    -   [Parameters][12]
-   [vm.runCode][13]
    -   [Parameters][14]
-   [runCode~callback][15]
    -   [Parameters][16]
-   [Event: beforeBlock][17]
    -   [Properties][18]
-   [Event: afterBlock][19]
    -   [Properties][20]
-   [Event: beforeTx][21]
    -   [Properties][22]
-   [Event: afterTx][23]
    -   [Properties][24]
-   [Event: newContract][25]
    -   [Properties][26]
-   [Event: step][27]
    -   [Properties][28]

## vm.runBlockchain

Processes blocks and adds them to the blockchain

### Parameters

-   `blockchain` **Blockchain** A [blockchain][29] that to process
-   `cb` **[Function][30]** the callback function

## VM

VM Class, `new VM(opts)` creates a new VM object

### Parameters

-   `opts` **[Object][31]** 
    -   `opts.stateManager` **StateManager** a state manager instance (EXPERIMENTAL - unstable API)
    -   `opts.state` **Trie** a merkle-patricia-tree instance for the state tree (ignored if stateManager is passed)
    -   `opts.blockchain` **Blockchain** a blockchain object for storing/retrieving blocks (ignored if stateManager is passed)
    -   `opts.chain` **([String][32] \| [Number][33])** the chain the VM operates on [default: 'mainnet']
    -   `opts.hardfork` **[String][32]** hardfork rules to be used [default: 'byzantium', supported: 'byzantium' (will throw on unsupported)]
    -   `opts.activatePrecompiles` **[Boolean][34]** create entries in the state tree for the precompiled contracts
    -   `opts.allowUnlimitedContractSize` **[Boolean][34]** allows unlimited contract sizes while debugging. By setting this to `true`, the check for contract size limit of 24KB (see [EIP-170][35]) is bypassed. (default: `false`; ONLY set to `true` during debugging)
    -   `opts.emitFreeLogs` **[Boolean][34]** Changes the behavior of the LOG opcode, the gas cost of the opcode becomes zero and calling it using STATICCALL won't throw. (default: `false`; ONLY set to `true` during debugging)

## vm.runBlock

Processes the `block` running all of the transactions it contains and updating the miner's account

### Parameters

-   `opts`  
    -   `opts.block` **Block** the [`Block`][36] to process
    -   `opts.generate` **[Boolean][34]** [gen=false] whether to generate the stateRoot, if false `runBlock` will check the stateRoot of the block against the Trie
-   `cb` **[runBlock~callback][37]** callback

## runBlock~callback

Callback for `runBlock` method

Type: [Function][30]

### Parameters

-   `error` **[Error][38]** an error that may have happened or `null`
-   `results` **[Object][31]** 
    -   `results.receipts` **[Array][39]** the receipts from the transactions in the block
    -   `results.results` **[Array][39]** 

## runTx~callback

Callback for `runTx` method

Type: [Function][30]

### Parameters

-   `error` **[Error][38]** an error that may have happened or `null`
-   `results` **[Object][31]** 
    -   `results.amountSpent` **BN** the amount of ether used by this transaction as a `bignum`
    -   `results.gasUsed` **BN** the amount of gas as a `bignum` used by the transaction
    -   `results.gasRefund` **BN** the amount of gas as a `bignum` that was refunded during the transaction (i.e. `gasUsed = totalGasConsumed - gasRefund`)
-   `vm` **[VM][40]** contains the results from running the code, if any, as described in `vm.runCode(params, cb)`

## vm.runTx

Process a transaction. Run the vm. Transfers eth. Checks balances.

### Parameters

-   `opts`  
    -   `opts.tx` **Transaction** a [`Transaction`][41] to run
    -   `opts.skipNonce` **[Boolean][34]** skips the nonce check
    -   `opts.skipBalance` **[Boolean][34]** skips the balance check
    -   `opts.block` **Block** the block to which the `tx` belongs, if no block is given a default one is created
-   `cb` **[runTx~callback][42]** the callback

## vm.runCode

Runs EVM code

### Parameters

-   `opts` **[Object][31]** 
    -   `opts.account` **Account** the [`Account`][43] that the executing code belongs to. If omitted an empty account will be used
    -   `opts.address` **[Buffer][44]** the address of the account that is executing this code. The address should be a `Buffer` of bytes. Defaults to `0`
    -   `opts.block` **Block** the [`Block`][36] the `tx` belongs to. If omitted a blank block will be used
    -   `opts.caller` **[Buffer][44]** the address that ran this code. The address should be a `Buffer` of 20bits. Defaults to `0`
    -   `opts.code` **[Buffer][44]** the EVM code to run given as a `Buffer`
    -   `opts.data` **[Buffer][44]** the input data
    -   `opts.gasLimit` **[Buffer][44]** the gas limit for the code
    -   `opts.origin` **[Buffer][44]** the address where the call originated from. The address should be a `Buffer` of 20bits. Defaults to `0`
    -   `opts.value` **[Buffer][44]** the value in ether that is being sent to `opt.address`. Defaults to `0`
-   `cb` **[runCode~callback][45]** callback

## runCode~callback

Callback for `runCode` method

Type: [Function][30]

### Parameters

-   `error` **[Error][38]** an error that may have happened or `null`
-   `results` **[Object][31]** 
    -   `results.gas` **BN** the amount of gas left
    -   `results.gasUsed` **BN** the amount of gas as a `bignum` the code used to run
    -   `results.gasRefund` **BN** a `bignum` containing the amount of gas to refund from deleting storage values
    -   `results.selfdestruct` **[Object][31]** an `Object` with keys for accounts that have selfdestructed and values for balance transfer recipient accounts
    -   `results.logs` **[Array][39]** an `Array` of logs that the contract emitted
    -   `results.exception` **[Number][33]** `0` if the contract encountered an exception, `1` otherwise
    -   `results.exceptionError` **[String][32]** a `String` describing the exception if there was one
    -   `results.return` **[Buffer][44]** a `Buffer` containing the value that was returned by the contract

## Event: beforeBlock

The `beforeBlock` event

Type: [Object][31]

### Properties

-   `block` **Block** emits the block that is about to be processed

## Event: afterBlock

The `afterBlock` event

Type: [Object][31]

### Properties

-   `result` **[Object][31]** emits the results of processing a block

## Event: beforeTx

The `beforeTx` event

Type: [Object][31]

### Properties

-   `tx` **Transaction** emits the Transaction that is about to be processed

## Event: afterTx

The `afterTx` event

Type: [Object][31]

### Properties

-   `result` **[Object][31]** result of the transaction

## Event: newContract

The `newContract` event when a contract is created

Type: [Object][31]

### Properties

-   `address` **[Buffer][44]** the created address for the new contract (type `Buffer | Uint8Array`)
-   `code` **[Buffer][44]** the deployment bytecode for reference (type `Buffer | Uint8Array`)

## Event: step

The `step` event for trace output

Type: [Object][31]

### Properties

-   `pc` **[Number][33]** representing the program counter
-   `opcode` **[String][32]** the next opcode to be ran
-   `gasLeft` **BN** amount of gasLeft
-   `stack` **[Array][39]** an `Array` of `Buffers` containing the stack
-   `account` **Account** the [`Account`][46] which owns the code running
-   `address` **[Buffer][44]** the address of the `account`
-   `depth` **[Number][33]** the current number of calls deep the contract is
-   `memory` **[Buffer][44]** the memory of the VM as a `buffer`
-   `storageManager` **StateManager** a state manager instance (EXPERIMENTAL - unstable API)

[1]: #vmrunblockchain

[2]: #parameters

[3]: #vm

[4]: #parameters-1

[5]: #vmrunblock

[6]: #parameters-2

[7]: #runblockcallback

[8]: #parameters-3

[9]: #runtxcallback

[10]: #parameters-4

[11]: #vmruntx

[12]: #parameters-5

[13]: #vmruncode

[14]: #parameters-6

[15]: #runcodecallback

[16]: #parameters-7

[17]: #event-beforeblock

[18]: #properties

[19]: #event-afterblock

[20]: #properties-1

[21]: #event-beforetx

[22]: #properties-2

[23]: #event-aftertx

[24]: #properties-3

[25]: #event-newcontract

[26]: #properties-4

[27]: #event-step

[28]: #properties-5

[29]: https://github.com/ethereum/ethereumjs-blockchain

[30]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[31]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[32]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[33]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[34]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[35]: https://git.io/vxZkK

[36]: https://github.com/ethereumjs/ethereumjs-block

[37]: #runblockcallback

[38]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error

[39]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[40]: #vm

[41]: https://github.com/ethereum/ethereumjs-tx

[42]: #runtxcallback

[43]: https://github.com/ethereumjs/ethereumjs-account

[44]: https://nodejs.org/api/buffer.html

[45]: #runcodecallback

[46]: https://github.com/ethereum/ethereumjs-account
